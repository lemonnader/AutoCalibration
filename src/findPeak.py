import numpy as np
import matplotlib.pyplot as plt

data = (
    11, 11, 12, 12, 14, 14, 14, 14, 15, 16, 16, 16, 16, 16, 16, 16, 18, 18, 20, 21, 22, 24, 25, 27, 29, 29, 30, 33, 35,
    36,
    36, 36, 35, 36, 37, 38, 40, 40, 38, 38, 40, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 41, 40, 38, 37, 35, 34, 33, 29,
    27,
    25, 24, 22, 20, 18, 17, 16, 15, 15, 15, 17, 17, 17, 16, 15, 12, 11, 11, 12, 12, 14, 14, 14, 14, 16, 18, 22, 23, 25,
    27,
    29, 33, 34, 36, 40, 42, 46, 49, 54, 59, 62, 67, 73, 76, 80, 80, 81, 82, 83, 83, 83, 83, 87, 88, 88, 88, 88, 89, 90,
    90,
    88, 88, 87, 87, 87, 87, 87, 86, 85, 83, 81, 79, 75, 70, 64, 59, 51, 46, 42, 41, 37, 34, 30, 27, 25, 27, 27, 27, 25,
    25,
    27, 27, 25, 25, 28, 30, 30, 30, 30, 31, 33, 31, 33, 35, 37, 38, 44, 51, 57, 64, 68, 75, 82, 88, 96, 102, 108, 114,
    120,
    123, 126, 128, 129, 128, 129, 131, 132, 134, 135, 136, 136, 136, 135, 135, 134, 134, 134, 134, 133, 133, 129, 129,
    127,
    126, 125, 121, 115, 110, 101, 93, 86, 80, 73, 66, 59, 51, 50, 48, 46, 46, 44, 42, 38, 37, 36, 37, 40, 42, 42, 43,
    44,
    46, 47, 49, 50, 53, 56, 61, 67, 73, 79, 82, 96, 102, 108, 118, 136, 145, 155, 165, 180, 187, 190, 197, 200, 204,
    206,
    207, 208, 210, 211, 212, 216, 217, 217, 218, 219, 219, 219, 219, 218, 217, 216, 214, 214, 214, 211, 205, 197, 187,
    174,
    161, 147, 134, 120, 108, 100, 94, 77, 70, 66, 63, 60, 57, 55, 53, 51, 50, 49, 50, 51, 51, 53, 54, 54, 56, 59, 62,
    69,
    76, 81, 86, 102, 110, 129, 140, 154, 168, 182, 193, 213, 214, 219, 225, 227, 231, 231, 227, 231, 231, 232, 233, 233,
    234, 234, 236, 236, 236, 234, 231, 229, 227, 227, 229, 230, 227, 226, 224, 219, 214, 207, 199, 181, 172, 153, 138,
    127,
    113, 103, 96, 85, 76, 70, 68, 62, 56, 54, 53, 51, 50, 48, 48, 48, 47, 47, 47, 51, 51, 54, 56, 60, 67, 76, 83, 101,
    102,
    127, 133, 154, 164, 164, 174, 193, 195, 197, 197, 197, 197, 195, 194, 194, 195, 195, 198, 200, 201, 199, 195, 192,
    186,
    179, 171, 164, 161, 160, 158, 159, 159, 158, 153, 146, 139, 131, 123, 107, 100, 94, 89, 81, 73, 66, 60, 56, 53, 48,
    44,
    43, 41, 40, 40, 38, 37, 36, 37, 36, 35, 35, 35, 34, 33, 34, 35, 37, 41, 46, 50, 56, 62, 68, 75, 85, 93, 100, 106,
    112,
    118, 120, 121, 125, 127, 127, 126, 126, 127, 129, 132, 133, 134, 135, 135, 136, 136, 136, 134, 131, 127, 126, 126,
    126,
    123, 121, 120, 116, 113, 107, 103, 96, 88, 81, 77, 69, 61, 59, 51, 48, 44, 41, 37, 36, 34, 31, 31, 31, 31, 30, 29,
    28,
    28, 27, 27, 28, 27, 25, 24, 24, 24, 27, 28, 27, 34, 38, 42, 47, 51, 56, 60, 66, 69, 74, 79, 82, 85, 86, 86, 87, 88,
    89,
    90, 92, 93, 92, 90, 90, 90, 90, 92, 92, 92, 92, 90, 88, 88, 87, 85, 81, 79, 75, 74, 73, 69, 67, 64, 57, 53, 47, 42,
    38,
    38, 36, 35, 34, 33, 29, 27, 28, 27, 25, 24, 23, 21, 20, 18, 18, 17, 16, 16, 16, 16, 16, 17, 16, 16, 17, 17, 18, 20,
    21,
    22, 22, 23, 25, 28, 29, 29, 29, 29, 31, 33, 35, 35, 34, 33, 33, 33, 33, 34, 35, 35, 34, 33, 33, 31, 30, 29, 29, 28,
    28,
    25, 24, 24)
data = np.array(data)

for i in range(len(data)):
    if i > 5 and (len(data) - i) > 5:
        data[i] = np.mean(data[i - 2:i + 2])

size = 10
index = []
for i in range(len(data)):  # 找峰
    if i > size and (len(data) - i) > 5 and data[i] == np.max(data[i - size:i + size]):
        index.append(i)
print(index)
cut_ind = []
for i in range(len(index) - 1):  # 定位连续的峰的最后一个峰 ， 也可以将连续的峰取均值或中值
    if abs(index[i] - index[i + 1]) > 20:
        cut_ind.append(index[i])
print(cut_ind)
plt.plot(data)
plt.scatter(cut_ind, data[cut_ind])
plt.show()
